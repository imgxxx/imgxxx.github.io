<!DOCTYPE html>
<html>
<head>
    <title>IP查询</title>
</head>
<body>
    <h1>IP查询</h1>

    <form id="ipForm" onsubmit="queryIP()">
        <label for="ipInput">请输入IP地址：</label>
        <input type="text" id="ipInput" placeholder="例如：8.8.8.8">
        <button type="submit">查询</button>
    </form>

    <div id="result"></div>

    <script>
        function displayIP(ip) {
            document.getElementById("result").innerHTML = `您的IP地址是：${ip}`;
        }

        function queryIP() {
            var inputIP = document.getElementById("ipInput").value;
            var url = `http://ip-api.com/json/${inputIP}`;

            // 发起请求
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    displayIP(data.query);
                })
                .catch(error => {
                    console.log(error);
                });

            event.preventDefault(); // 阻止表单提交的默认行为
        }

        // 页面加载完成后自动查询IP
        window.onload = function() {
            queryIP();
            var inputIP = document.getElementById("ipInput");
            fetch('https://api.ipify.org?format=json')
                .then(response => response.json())
                .then(data => {
                    inputIP.value = data.ip;
                })
                .catch(error => {
                    console.log(error);
                });
        };
    </script>
</body>
</html>